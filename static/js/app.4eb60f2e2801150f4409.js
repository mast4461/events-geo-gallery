webpackJsonp([2,0],[function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}var i=n(135),a=o(i),r=n(127),s=o(r);new a["default"]({el:"body",components:{App:s["default"]}})},,,,,,,,,,,,,,,function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i,a=n(30),r=o(a),s=n(31),c=o(s),u=window.L,l=function(){function e(t,n,o){(0,r["default"])(this,e);var a={};void 0!==o&&(a.title=o),this.marker=u.marker(t,a).addTo(i),void 0!==o&&this.marker.bindPopup(o),n&&(this.onClick=n,this.marker.on("click",n))}return(0,c["default"])(e,[{key:"destroy",value:function(){i.removeLayer(this.marker),this.onClick&&this.marker.off("click",this.onClick)}},{key:"setLatLng",value:function(e){this.marker.setLatLng(e)}},{key:"openPopup",value:function(){this.marker.openPopup()}},{key:"closePopup",value:function(){this.marker.closePopup()}}]),e}();t["default"]={createMap:function(e){i=u.map(e),window.map=i,i.setView([0,0],0),u.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(i)},addMarker:function(e,t,n){return new l(e,t,n)},setView:function(e,t){i.setView(e,t)},fitLatLngs:function(e){i.fitBounds(u.latLngBounds(e),{padding:[30,30]})}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(){return console.log("initializing"),new x["default"](function(e,t){var n=(0,L.getAccessToken)();void 0===n?(console.log("Token not found in URL"),t("Token not found in URL"),window.location="https://www.dropbox.com/1/oauth2/authorize?client_id=iybymu5ptwg7vkc&response_type=token&redirect_uri=https://mast4461.github.io/events-geo-gallery/"):(b.setAccessToken(n),e())})}function a(e){return b.filesDownload({path:e}).then(function(e){return(0,k["default"])(e.fileBlob,"text")}).then(JSON.parse)}function r(e){return e.entries=e.entries.sort(function(e,t){var n=e.path_lower,o=t.path_lower;return n<o?-1:n>o?1:0}),e}function s(e){var t=e.entries,n=[];return t.forEach(function(e){var t=e.path_lower.split("/");t.shift();var o=n,i=t.length;t.forEach(function(t,n){var a=o.find(function(e){return e.name===t});if(a)o=a.children;else{var r={name:t,children:[]};n===i-1&&(r.item=e),o.push(r),o=r.children}})}),n[0]}function c(e){var t={name:e.name,locations:e.children.map(function(e){return{name:e.name,categories:e.children.filter(function(e){return"folder"===e.item[".tag"]}).map(function(e){return{name:e.name,images:e.children.map(function(e){return{name:e.name,path:e.item.path_lower,getThumbnailBlob:function(){return b.filesGetThumbnail({path:e.item.id,size:"w640h480"}).then(function(e){return e.fileBlob})}}})}}),getGeoJson:function(){var t=e.children.find(function(e){return/\.geo\.json/.test(e.name)});return t?a(t.item.path_lower):x["default"].resolve(void 0)},latLng:void 0}})};return t.locations=t.locations.sort(function(e,t){var n=e.name.toUpperCase(),o=t.name.toUpperCase();return n<o?-1:n>o?1:0}),t}function u(e){var t=e.locations.map(function(e){return e.getGeoJson().then(function(t){t&&(delete e.getGeoJson,e.latLng=l(t))})});return x["default"].all(t).then(function(){return console.log("returning tree"),e})}function l(e){var t=e.features[0].geometry.coordinates;return[t[1],t[0]]}function f(e){return b.filesListFolder(e).then(function(e){return e.entries.map(function(e){return new M(e)})})["catch"](d)}function d(e){throw console.log(e),e}Object.defineProperty(t,"__esModule",{value:!0});var p=n(30),h=o(p),v=n(31),g=o(v),m=n(60),x=o(m),y=n(103),_=o(y),w=n(116),k=o(w),L=n(46),b=new _["default"],M=function(){function e(t){(0,h["default"])(this,e),this.name=t.name,this.path=t.path_lower}return(0,g["default"])(e,[{key:"getContents",value:function(){return f({path:this.path})}},{key:"getThumbnail",value:function(){return b.filesGetThumbnail({path:this.path})["catch"](d)}},{key:"getLatLng",value:function(){return a(this.path).then(function(e){return e.features[0].geometry.coordinates}).then(function(e){return[e[1],e[0]]})}},{key:"getEventData",value:function(){return b.filesListFolder({path:this.path,recursive:!0}).then(function(e){return console.log({raw:e}),e}).then(r).then(s).then(c).then(u)["catch"](d)}}]),e}();t["default"]={getEvents:function(){return f({path:""})},init:i}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(){return window.location.hash.substring(1).split("&").reduce(function(e,t){var n=t.split("="),o=(0,s["default"])(n,2),i=o[0],a=o[1];return e[i]=a,e},{})}function a(){var e=i(),t="access_token";return e.hasOwnProperty(t)?e[t]:void 0}Object.defineProperty(t,"__esModule",{value:!0}),t.getAccessToken=t.getHashParameters=void 0;var r=n(61),s=o(r);t.getHashParameters=i,t.getAccessToken=a},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(131),a=o(i);t["default"]={components:{GeoEventsView:a["default"]}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(134),a=o(i);t["default"]={props:["categoryData"],components:{Thumbnail:a["default"]},computed:{images:function(){return this.categoryData?this.categoryData.images:[]}}}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={props:["imgSrc","alt","show","text"],methods:{updateDialogState:function(){this.show&&!this.$el.open?this.$el.show():!this.show&&this.$el.open&&this.$el.close()},close:function(){this.$el.close()}},watch:{show:function(){this.updateDialogState()}},ready:function(){document.body.appendChild(this.$el),this.updateDialogState()}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(58),a=o(i),r=n(132),s=o(r),c=n(133),u=o(c),l=n(15),f=o(l);t["default"]={props:["eventMetaData"],components:{LocationView:s["default"],MapMarker:u["default"]},data:function(){return{selectedLocation:void 0,eventData:void 0}},computed:{string:function(){return(0,a["default"])(this.eventData,null,2)},locations:function(){return this.eventData?this.eventData.locations:[]},latLngs:function(){return this.locationsWithCoordinates.map(function(e){return e.latLng})},locationsWithCoordinates:function(){return this.locations.filter(function(e){return e.latLng})}},methods:{fetchEventData:function(){var e=this;this.eventMetaData.getEventData().then(function(t){e.eventData=t,console.log((0,a["default"])(e.eventData,null,2)),e.zoomToExtent()})["catch"](function(e){return console.log(e)})},getLocationSelector:function(e){var t=this;return function(){t.selectedLocation=e,t.viewSelectedLocation()}},zoomToExtent:function(){f["default"].fitLatLngs(this.latLngs)},viewSelectedLocation:function(){var e=this.selectedLocation.latLng;e?f["default"].setView(this.selectedLocation.latLng):this.zoomToExtent()}},watch:{eventMetaData:function(){this.fetchEventData()},selectedLocation:function(){this.viewSelectedLocation()}},ready:function(){this.fetchEventData()}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(130),a=o(i),r=n(45),s=o(r),c=n(15),u=o(c);t["default"]={components:{GeoEvent:a["default"]},data:function(){return{msg:"hello",geoEvents:[],selectedGeoEvent:void 0}},ready:function(){u["default"].createMap("map-container"),s["default"].init()["catch"](function(e){return console.log(e)}).then(this.fetchEvents)},watch:{geoEvents:function(){1===this.geoEvents.length&&(this.selectedGeoEvent=this.geoEvents[0])}},methods:{fetchEvents:function(){var e=this;s["default"].getEvents().then(function(t){e.$set("geoEvents",t)})}}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(62),a=o(i),r=n(128),s=o(r);t["default"]={props:["locationData"],components:{CategoryView:s["default"]},data:function(){return{checkedCategories:[],latLng:void 0}},computed:{categories:function(){return this.locationData?this.locationData.categories:[]}},watch:{categories:function(){this.checkedCategories=[].concat((0,a["default"])(this.categories))}}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(15),a=o(i);t["default"]={props:{latLng:{type:Array,required:!0},clickHandler:{type:Function},title:{type:String},isSelected:{type:Boolean}},data:function(){return{marker:void 0}},ready:function(){this.marker=a["default"].addMarker(this.latLng,this.clickHandler,this.title)},beforeDestroy:function(){this.marker.destroy()},watch:{latLng:function(){this.marker.setLatLng(this.latLng)},isSelected:function(){this.isSelected?this.marker.openPopup():this.marker.closePopup()}}}},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(129),a=o(i),r=window.URL||window.webkitURL;t["default"]={props:["imageData"],components:{FullscreenImage:a["default"]},data:function(){return{imgSrc:"",isFullscreen:!1}},methods:{updateImgSrc:function(){var e=this;this.revokeImgSrc(),this.imageData.getThumbnailBlob().then(function(t){e.imgSrc=r.createObjectURL(t)})},revokeImgSrc:function(){this.imgSrc&&r.revokeObjectURL(this.imgSrc)},fullScreen:function(){console.log("fullScreen"),this.isFullscreen=!this.isFullscreen}},watch:{imageData:function(){this.updateImgSrc()}},ready:function(){this.updateImgSrc()},beforeDestroy:function(){this.revokeImgSrc()}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},,,,,,function(e,t){e.exports=" <div id=app> <geo-events-view></geo-events-view> </div> "},function(e,t){e.exports=' <div class=category-view> <h3>{{categoryData.name}}</h3> <thumbnail v-for="image in images" :image-data=image></thumbnail> </div> '},function(e,t){e.exports=" <dialog class=fullscreen> <img class=fullscreen :src=imgSrc :alt=alt @click=close> <p>{{text}}</p> </dialog> "},function(e,t){e.exports=' <div> <h2>{{eventMetaData.name}}</h2> <label for=location-selector>Location:</label> <select name=location-selector id=location-selector v-model=selectedLocation> <option v-for="location in locations" :value=location>{{location.name}}</option> </select> <location-view v-if=selectedLocation :location-data=selectedLocation></location-view> <map-marker v-for="location in locationsWithCoordinates" :lat-lng=location.latLng :click-handler=getLocationSelector(location) :title=location.name :is-selected="location === selectedLocation"></map-marker> </div> '},function(e,t){e.exports=' <div> <label for=event-selector>Event:</label> <select name=event-selector id=event-selector v-model=selectedGeoEvent> <option v-for="geoEvent in geoEvents" :value=geoEvent>{{geoEvent.name}}</option> </select> <div id=map-container></div> <geo-event v-if=selectedGeoEvent :event-meta-data=selectedGeoEvent></geo-event> </div> '},function(e,t){e.exports=' <div> <h2>{{locationData.name}}</h2> <p v-if="locationData && !locationData.latLng">Coordinates missing</p> <template v-for="category in categories"> <input type=checkbox :id=category.name :value=category v-model=checkedCategories checked=checked> <label :for=category.name>{{category.name}}</label> </template> <div id=categories> <category-view v-for="category in categories" :category-data=category v-show=checkedCategories.includes(category)></category-view> <div v-if="categories.length === 0">No images for this location</div> </div> </div> '},function(e,t){e.exports=" <div> <img class=thumbnail :src=imgSrc :alt=imageData.path @click=fullScreen> <p>{{imageData.name}}</p> <fullscreen-image :show=isFullscreen :img-src=imgSrc :alt=imageData.path :text=imageData.name></fullscreen-image> </div> "},function(e,t,n){var o,i;n(109),o=n(47),i=n(120),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)},function(e,t,n){var o,i;n(110),o=n(48),i=n(121),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)},function(e,t,n){var o,i;n(111),o=n(49),i=n(122),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)},function(e,t,n){var o,i;o=n(50),i=n(123),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)},function(e,t,n){var o,i;n(112),o=n(51),i=n(124),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)},function(e,t,n){var o,i;n(113),o=n(52),i=n(125),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)},function(e,t,n){var o,i;o=n(53),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)},function(e,t,n){var o,i;n(114),o=n(54),i=n(126),e.exports=o||{},e.exports.__esModule&&(e.exports=e.exports["default"]),i&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=i)},,,,function(e,t){}]);
//# sourceMappingURL=app.4eb60f2e2801150f4409.js.map