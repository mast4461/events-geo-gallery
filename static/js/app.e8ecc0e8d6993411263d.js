webpackJsonp([2,0],[function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}var a=n(131),i=o(a),r=n(124),c=o(r);new i["default"]({el:"body",components:{App:c["default"]}})},,,,,,,,,,,,,,,function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=window.L;e["default"]={createMap:function(t){n=o.map(t),window.map=n,n.setView([0,0],0),o.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(n)},addMarker:function(t,e){var a=o.marker(t).addTo(n);return e&&a.on("click",e),{destroy:function(){n.removeLayer(a),e&&a.off("click",e)},setLatLng:function(t){a.setLatLng(t)}}},setView:function(t,e){n.setView(t,e)},fitLatLngs:function(t){n.fitBounds(o.latLngBounds(t),{padding:[30,30]})}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(){return window.location.hash.substring(1).split("&").reduce(function(t,e){var n=e.split("="),o=(0,c["default"])(n,2),a=o[0],i=o[1];return t[a]=i,t},{})}function i(){var t=a(),e="access_token";return t.hasOwnProperty(e)?t[e]:void 0}Object.defineProperty(e,"__esModule",{value:!0}),e.getAccessToken=e.getHashParameters=void 0;var r=n(60),c=o(r);e.getHashParameters=a,e.getAccessToken=i},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function a(){return console.log("initializing"),new m["default"](function(t,e){var n=(0,L.getAccessToken)();void 0===n?(console.log("Token not found in URL"),e("Token not found in URL"),window.location="https://www.dropbox.com/1/oauth2/authorize?client_id=iybymu5ptwg7vkc&response_type=token&redirect_uri=https://mast4461.github.io/events-geo-gallery/"):(b.setAccessToken(n),t())})}function i(t){return b.filesDownload({path:t}).then(function(t){return(0,w["default"])(t.fileBlob,"text")}).then(JSON.parse)}function r(t){var e=t.entries,n=[];return e.forEach(function(t){var e=t.path_lower.split("/");e.shift();var o=n,a=e.length;e.forEach(function(e,n){var i=o.find(function(t){return t.name===e});if(i)o=i.children;else{var r={name:e,children:[]};n===a-1&&(r.item=t),o.push(r),o=r.children}})}),n[0]}function c(t){var e={name:t.name,locations:t.children.map(function(t){return{name:t.name,categories:t.children.filter(function(t){return"folder"===t.item[".tag"]}).map(function(t){return{name:t.name,images:t.children.map(function(t){return{name:t.name,path:t.item.path_lower,getThumbnailBlob:function(){return b.filesGetThumbnail({path:t.item.id,size:"w640h480"}).then(function(t){return t.fileBlob})}}})}}),getGeoJson:function(){var e=t.children.find(function(t){return/\.geo\.json/.test(t.name)});return e?i(e.item.path_lower):m["default"].resolve(void 0)},latLng:void 0}})};return e.locations=e.locations.sort(function(t,e){var n=t.name.toUpperCase(),o=e.name.toUpperCase();return n<o?-1:n>o?1:0}),e}function s(t){var e=t.locations.map(function(t){return t.getGeoJson().then(function(e){e&&(delete t.getGeoJson,t.latLng=u(e))})});return m["default"].all(e).then(function(){return console.log("returning tree"),t})}function u(t){var e=t.features[0].geometry.coordinates;return[e[1],e[0]]}function l(t){return b.filesListFolder(t).then(function(t){return t.entries.map(function(t){return new k(t)})})["catch"](f)}function f(t){throw console.log(t),t}Object.defineProperty(e,"__esModule",{value:!0});var d=n(58),p=o(d),v=n(59),h=o(v),g=n(57),m=o(g),x=n(102),y=o(x),_=n(114),w=o(_),L=n(43),b=new y["default"],k=function(){function t(e){(0,p["default"])(this,t),this.name=e.name,this.path=e.path_lower}return(0,h["default"])(t,[{key:"getContents",value:function(){return l({path:this.path})}},{key:"getThumbnail",value:function(){return b.filesGetThumbnail({path:this.path})["catch"](f)}},{key:"getLatLng",value:function(){return i(this.path).then(function(t){return t.features[0].geometry.coordinates}).then(function(t){return[t[1],t[0]]})}},{key:"getEventData",value:function(){return b.filesListFolder({path:this.path,recursive:!0}).then(r).then(c).then(s)["catch"](f)}}]),t}();e["default"]={getEvents:function(){return l({path:""})},init:a}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(127),i=o(a);e["default"]={components:{GeoEventsView:i["default"]}}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(130),i=o(a);e["default"]={props:["categoryData"],components:{Thumbnail:i["default"]},computed:{images:function(){return this.categoryData?this.categoryData.images:[]}}}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(55),i=o(a),r=n(128),c=o(r),s=n(129),u=o(s),l=n(15),f=o(l);e["default"]={props:["eventMetaData"],components:{LocationView:c["default"],MapMarker:u["default"]},data:function(){return{selectedLocation:void 0,eventData:void 0}},computed:{string:function(){return(0,i["default"])(this.eventData,null,2)},locations:function(){return this.eventData?this.eventData.locations:[]},latLngs:function(){return this.locationsWithCoordinates.map(function(t){return t.latLng})},locationsWithCoordinates:function(){return this.locations.filter(function(t){return t.latLng})}},methods:{fetchEventData:function(){var t=this;this.eventMetaData.getEventData().then(function(e){t.eventData=e,console.log((0,i["default"])(t.eventData,null,2)),t.zoomToExtent()})["catch"](function(t){return console.log(t)})},getLocationSelector:function(t){var e=this;return function(){e.selectedLocation=t}},zoomToExtent:function(){f["default"].fitLatLngs(this.latLngs)}},watch:{eventMetaData:function(){this.fetchEventData()},selectedLocation:function(){var t=this.selectedLocation.latLng;t?f["default"].setView(this.selectedLocation.latLng):this.zoomToExtent()}},ready:function(){this.fetchEventData()}}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(126),i=o(a),r=n(44),c=o(r),s=n(15),u=o(s);e["default"]={components:{GeoEvent:i["default"]},data:function(){return{msg:"hello",geoEvents:[],selectedGeoEvent:void 0}},ready:function(){u["default"].createMap("map-container"),c["default"].init()["catch"](function(t){return console.log(t)}).then(this.fetchEvents)},watch:{geoEvents:function(){1===this.geoEvents.length&&(this.selectedGeoEvent=this.geoEvents[0])}},methods:{fetchEvents:function(){var t=this;c["default"].getEvents().then(function(e){t.$set("geoEvents",e)})}}}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(61),i=o(a),r=n(125),c=o(r);e["default"]={props:["locationData"],components:{CategoryView:c["default"]},data:function(){return{checkedCategories:[],latLng:void 0}},computed:{categories:function(){return this.locationData?this.locationData.categories:[]}},watch:{categories:function(){this.checkedCategories=[].concat((0,i["default"])(this.categories))}}}},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var a=n(15),i=o(a);e["default"]={props:{latLng:{type:Array,required:!0},clickHandler:{type:Function}},data:function(){return{marker:void 0}},ready:function(){this.marker=i["default"].addMarker(this.latLng,this.clickHandler)},beforeDestroy:function(){this.marker.destroy()},watch:{latLng:function(){this.marker.setLatLng(this.latLng)}}}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=window.URL||window.webkitURL;e["default"]={props:["imageData"],data:function(){return{imgSrc:""}},methods:{updateImgSrc:function(){var t=this;this.revokeImgSrc(),this.imageData.getThumbnailBlob().then(function(e){t.imgSrc=n.createObjectURL(e)})},revokeImgSrc:function(){this.imgSrc&&n.revokeObjectURL(this.imgSrc)},fullScreen:function(){console.log("fullScreen")}},watch:{imageData:function(){this.updateImgSrc()}},ready:function(){this.updateImgSrc()},beforeDestroy:function(){this.revokeImgSrc()}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){},function(t,e){},function(t,e){},function(t,e){},function(t,e){},,,,,,function(t,e){t.exports=" <div id=app> <geo-events-view></geo-events-view> </div> "},function(t,e){t.exports=' <div class=category-view> <h3>{{categoryData.name}}</h3> <thumbnail v-for="image in images" :image-data=image></thumbnail> </div> '},function(t,e){t.exports=' <div> <h2>{{eventMetaData.name}}</h2> <select name=location-selector id=location-selector v-model=selectedLocation> <option v-for="location in locations" :value=location>{{location.name}}</option> </select> <label for=location-selector>Select a location</label> <location-view v-if=selectedLocation :location-data=selectedLocation></location-view> <map-marker v-for="location in locationsWithCoordinates" :lat-lng=location.latLng :click-handler=getLocationSelector(location)></map-marker> </div> '},function(t,e){t.exports=' <div> <label for=event-selector>Event</label> <select name=event-selector id=event-selector v-model=selectedGeoEvent> <option v-for="geoEvent in geoEvents" :value=geoEvent>{{geoEvent.name}}</option> </select> <div id=map-container></div> <geo-event v-if=selectedGeoEvent :event-meta-data=selectedGeoEvent></geo-event> </div> '},function(t,e){t.exports=' <div> <h2>{{locationData.name}}</h2> <p v-if="locationData && !locationData.latLng">Coordinates missing</p> <template v-for="category in categories"> <input type=checkbox :id=category.name :value=category v-model=checkedCategories checked=checked> <label :for=category.name>{{category.name}}</label> </template> <div id=categories> <category-view v-for="category in categories" :category-data=category v-show=checkedCategories.includes(category)></category-view> <div v-if="categories.length === 0">No image categories for this location</div> </div> </div> '},function(t,e){t.exports=" <div> <img class=thumbnail :src=imgSrc :alt=imageData.path @click=fullScreen> <p>{{imageData.name}}</p> </div> "},function(t,e,n){var o,a;n(108),o=n(45),a=n(118),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),a&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=a)},function(t,e,n){var o,a;n(109),o=n(46),a=n(119),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),a&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=a)},function(t,e,n){var o,a;o=n(47),a=n(120),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),a&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=a)},function(t,e,n){var o,a;n(110),o=n(48),a=n(121),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),a&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=a)},function(t,e,n){var o,a;n(111),o=n(49),a=n(122),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),a&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=a)},function(t,e,n){var o,a;o=n(50),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),a&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=a)},function(t,e,n){var o,a;n(112),o=n(51),a=n(123),t.exports=o||{},t.exports.__esModule&&(t.exports=t.exports["default"]),a&&(("function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports).template=a)},,,,function(t,e){}]);
//# sourceMappingURL=app.e8ecc0e8d6993411263d.js.map